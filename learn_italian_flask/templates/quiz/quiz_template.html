{% extends "dashboard_template.html" %}

{% set active_page = "learn" %}

{% block styling %}
<style>
</style>
{% endblock %}

{% block heading %}
<h1>{{heading}}</h1>
{% endblock %}

{% block main_content %}
{% if completed %}
<div class="alert alert-success">Quiz successfully submitted!</div>
{% endif %}
<form id="form-quiz" action="" method="post" novalidate>
    {{ form.hidden_tag() }}

    {% for question in form %}
        {% if question.type == "StringField" %}
            {{ question.label }}
            <br>
            {% if completed %}
            {{ question(disabled=true) }}
                {% if solution[question.id]["is_correct"] %}
                    <i class="fas fa-check"></i>
                {% else %}
                    <i class="fas fa-times"></i>
                    <span class="alert alert-danger">{{solution[question.id]["solution"]}}</span>
                {% endif %}
            {% else %}
                {{ question }}
            {% endif %}
            {% for error in question.errors %}
                <div class="alert alert-danger">{{error}}</div>
            {% endfor %}
            <br>

        {% elif question.type == "IntegerField" %}
            {{ question.label }}
            <br>
            {% if completed %}
            {{ question(disabled=true) }}
                {% if solution[question.id]["is_correct"] %}
                    <i class="fas fa-check"></i>
                {% else %}
                    <i class="fas fa-times"></i>
                    <span class="alert alert-danger">{{solution[question.id]["solution"]}}</span>
                {% endif %}
            {% else %}
                {{ question }}
            {% endif %}
            {% for error in question.errors %}
                <div class="alert alert-danger">Please enter an integer between 0 and 999</div>
            {% endfor %}
            <br>

        {% elif question.type == "RadioField" %}
            {{ question.label }}
            {% for field in question%}
                <br>
                {% if completed %}
                    {{ field(disabled=true) }}
                {% else %}
                    {{ field }}
                {% endif %}

                {{ field.label }}
                
                {% if completed %}
                    {% if field.data == question.data and solution[question.id]["is_correct"] %}
                        <i class="fas fa-check"></i>
                    {% elif field.data == question.data %}
                        <i class="fas fa-times"></i>
                    {% elif field.data == solution[question.id]["solution"] %}
                        <i class="fas fa-check"></i>
                    {% endif %}
                {% endif %}
            {% endfor %}

            {% for error in question.errors %}
                <div class="alert alert-danger">Please select an option!</div>
            {% endfor %}
        
        {% elif question.type == "MultiCheckboxField" %}
            {{ question.label }}
            {% for field in question%}
                <br>
                {% if completed %}
                    {{ field(disabled=true) }}
                {% else %}
                    {{ field }}
                {% endif %}

                {{ field.label }}

                {% if solution and solution[question.id]["solution"][field.data|int] %}
                    <i class="fas fa-check"></i>
                {% elif solution %}
                    <i class="fas fa-times"></i>
                {% endif %}        
            {% endfor %}

        {% endif %}
        <br>
    {% endfor %}
    
    {% if completed %}
        {{ form.submit(disabled=true) }}
    {% else %}
        {{ form.submit }}
    {% endif %}
</form>
{% endblock %}
